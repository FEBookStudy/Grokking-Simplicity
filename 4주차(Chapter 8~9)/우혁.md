# 계층형 설계 I, II

> [!TIP]
> 소프트웨어 설계
>
> - 코드를 만들고, 테스트하고, 유지보수하기 쉬운 프로그래밍 방법을 선택하기 위해 미적 감각을 사용하는 것

<aside>
💡
설계 감각을 키우면 소프트웨어를 고치고, 읽고, 테스트하고, 재사용하기 쉬운 코드를 만들기 위한 계층구조를 알 수 있다.
</aside>

## 계층형 설계 패턴

### 1. 직접 구현

- 계층형 설계 구조를 만드는 데 도움이 된다.
- 함수 시그니처가 나타내고 있는 문제를 함수 본문에서 적절한 구체화수준에서 해결해야 한다.
- 너무 구체적이라면 코드 스멜이 나는 코드이다.

→ 함수가 모두 비슷한 계층에 있다면 직접 구현했다고 할 수 있다.

같은 계층에 있는 함수는 같은 목적을 가져야 한다.

함수를 추출하면 더 일반적인 함수로 만들 수 있다.

일반적인 함수가 많을 수록 재사용하기 쉽다.

### 2. 추상화 벽

- 중요한 세부 구현을 감추고 인터페이스를 제공
- 인터페이스를 사용하여 코드를 만드면 높은 차원으로 생각할 수 있다.

→ 추상화 벽은 라이브러리를 가져다 쓰는 것과 비슷하다.

세부 구현은 신경쓰지 않아도 된다.

벽을 가로지르는 화살표가 없다는 것이 중요하다.

모든 상황에 맞는 설계는 없다.

### 3. 작은 인터페이스

- 시스템이 커질수록 비지니스 개념을 나타내는 중요한 인터페이스는 작고 강력한 동작으로 구성
- 다른 동작도 직간접적으로 최소한의 인터페이스를 유지하면서 정의

→ 추상화 벽을 작게 만들기

함수의 목적에 맞는 계층이 어디인지 찾는 감각을 기르는 것이 중요하다.

### 4. 편리한 계층

- 개발자의 요구를 만족시키면서 비지니스 문제를 잘 풀 수 있어야 한다.
- 소프트웨어를 더 빠르고 고품질로 제공하는 데 도움이 되는 계층에 시간을 투자

→ 조금 더 현실적이고 실용적인 측면

거대한 추상 계층을 만들 시간적 여유가 없다.

불편하고 문제라고 생각되면 개선하기

## 정리하기

- 그래프의 가장 위에 있는 코드가 고치기 쉽다.
  - 수정이 다른 코드에 영향을 주지 않는다.
  - 비지니스 규칙처럼 자주 바뀌는 요구사항에 적합
- 그래프 아래에 있는 코드는 테스트가 중요하다.
  - 아래에 있는 코드는 여러 곳에 쓰여, 신뢰할 수 있게 만드는게 중요하다.
  - 위로 갈수록 테스트 코드의 수명이 짧아진다.

## 논의 사항

### Q1. p197 예제에서 어떤 코드가 더 좋아보이는지??

배열 인덱스는 언어만 알면 충분히 이해가 가능하고, 더 개선이 필요하지 않다고 느끼는데 이걸 새로운 함수를 만들어서 추상화하니깐 억지로 1depth 더 늘어난 느낌이다.

`arraySet` 은 값을 바꾸니깐 카피-온-라이트 원칙을 추상화하는건 괜찮은 것 같은데 `arrayGet` 까지 필요한지는 잘 모르겠다…

- 이러한 관점에서 화살표 길이가 중요할까?

### Q2. 그래프 아래에 있는 코드에 대해 테스트 코드를 짜야할 것 같은데 어느정도까지 짜는게 적당할지?

테스트 코드에 대한 경험이 없지만 요즘 우테코 준비하면서 `jest` 를 입문하는데 테스트 코드 설계를 어떻게 해야할 지 감이 안온다...

책에서는 아래에 있는 코드를 테스트 하라고 하는데 조금 극단적으로 보면 `이런 함수`는 테스트 코드가 필요 없을 것 같은데 `이런 함수` 라는 것에 조금 더 명확한 기준이 있어야 할 것 같다.

- 아래 함수보다 조금 더 복잡한 함수가 있다고 했을 때, 나는 그 함수 또한 테스트 코드가 필요 없다고 주장했는데, 다른 분은 필요하다고 주장할 수 있는 상황이 나올 수 있을 것 같아서 명확한 기준이 있으면 좋을 것 같다는 생각이 든다…

```tsx
const sum = (a, b) => a + b;
```
