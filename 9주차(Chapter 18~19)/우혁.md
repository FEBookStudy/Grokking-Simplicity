## Chapter 18. 반응형 아키텍처와 어니언 아키텍처

### 반응형 아키텍처: 순차적 액션 단계에서 사용

> 코드에서 나타난 순차적 액션의 순서를 뒤집는다.
> 효과와 그 효과에 대한 원인을 분리해서 복잡하게 꼬인 부분을 푼다.

이벤트에 대한 반응으로 시스템 동작을 정의한다.

ex) 제출 버튼을 클릭하면 서버에 post 요청을 한다.

- 이벤트 중심: 시스템의 모든 동작은 이벤트에 대한 반응으로 정의된다.
- 원인과 효과의 분리: 순차적 접근 방식과 달리, 원인(이벤트), 효과(반응)을 분리한다.
- 유연성: 새로운 기능을 추가하거나, 기존 기능을 수정할 때 유연하다.
- 파이프라인 처리: 여러 단계의 처리를 파이프라인 형태로 구성할 수 있어 복잡한 로직을 더 명확하게 표현할 수 있다.

→ 복잡한 상태 관리를 단순화할 수 있다.

---

### 어니언 아키텍처: 서비스의 모든 단계에서 사용

> 웹 서비스나 온도 조절 장치 같은 현실 세계와 상호작용하기 위한 서비스 구조를 만든다.
> 함수형 사고를 적용한다면 자연스럽게 쓸 수 있다.

시스템을 여러 계층으로 구분하여 구조화하는 방식이다. 관심사 분리를 통해 시스템을 더 모듈화하고 유지보수 하기 쉽게 만든다.

- 인터랙션 계층: 바깥 세상에 영향을 주거나 받는 액션
- 도메인 계층: 비즈니스 규칙을 정의하는 계산
- 언어 계층: 언어 유틸리티와 라이브러리

의존성 방향: 외부 계층에서 내부 계층으로의 의존성만 허용된다. 즉 도메인 계층은 인터랙션 계층에 의존하지 않는다.

도메인 중심: 비지니스 로직을 중심에 두어, 시스템의 핵심을 명확하게 표현한다.

테스트 용이성: 각 계층을 독립적으로 테스트할 수 있어 유닛 테스트가 용이하다.

---

### 두 아키텍처의 비교

반응형 아키텍처는 주로 시스템의 동작 흐름을 구조화하는 데 중점을 두는 반면,

어니언 아키텍처는 시스템의 전체적인 구조와 계층을 조직화하는 데 초점을 둔다.

→ 두 아키텍처는 상호보완적으로 사용될 수 있으며 복잡한 시스템에서 각각의 장점을 살려 효과적인 설계를 할 수 있다.

---

### 정리하기

반응형 아키텍처는 이벤트에 대한 반응으로 시스템을 구성해서 이벤트 핸들러의 기본 개념과 일치하고, 옵저버 패턴을 사용해 상태 변화가 발생하면 관련 컴포넌트에서 알림을 받을 수 있게 구성할 수 있다.

어니언 아키텍처는 시스템을 여러 계층으로 구분하여 관심사를 분리하여 관리하고, 외부 계층에서 내부 계층으로의 의존성만 허용한다.(FSD를 사용해보지는 않았지만 비슷한 개념이였던 것 같다)

---

## Chapter 19. 함수형 프로그래밍 여행에 앞서

### 함수형 프로그래밍 여행을 계속하기 위해…

- 함수형 언어를 배우기
- 수학적 지식을 얻기
- 더 많은 책을 읽기

---

### 꼭 기억해야할 것

- 어떤 경우에는 액션에 계산이 숨어있다.

  - 계산을 빼내는 것은 귀찮지만 가치있는 일이다.(재사용성, 테스트 용이 등)
  - 액션, 계산, 데이터를 구분하는 것은 함수형 프로그래밍의 기본이다.
  - 각각 다른 게층으로 구성할 수 있고, 넓은 관점에서 어니언 아키텍처로 구성하게 된다.

- 고차 함수를 사용하면 추상화에 대한 개념이 넓어진다.

  - 고차함수를 사용하면 똑같은 저수준의 코드를 반복하지 않아도 된다.

- 코드에서 시간의 의미는 마음대로 바꿀 수 있다.
  - 코드가 실행되는 순서가 이해하는 것은 매우 중요하다.
  - 다이어그램을 통해 액션이 동시에 실행되는지, 차례로 실행되는지 알 수 있다.
  - 함수형 개발자는 액션의 순서와 반복을 바꿀 수 있다.
    - 기본형을 만들어 문법적 실행 방법을 다른 순서나 반복으로 바꿀 수 있다.

---

### 시간에 따른 기술과 열정의 변화

새로운 기술을 배울 때마다 완전한 숙달을 위해 누구나 비슷한 과정을 거친다.

- 이것저것 적용해보고 기술의 한계를 느껴 추락한다.
- 서서히 기술을 적용할 때를 알게 되면 원래 알고 있던 다른 것들과 어떤 관계가 있는지 배우고 적용하지 않아야 할 때를 깨닫게 된다.

→ 함수형 프로그래밍을 적용하는 것이 무조건 좋은 것은 아니고, 다른 패러다임과 적절히 결합하고 사용하는 것이 중요하다.
