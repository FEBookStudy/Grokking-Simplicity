## Chapter 1. 쏙쏙 들어오는 함수형 코딩에 오신 것을 환영합니다.

### 함수형 프로그래밍에서는 코드를 세 가지로 분류한다.

1. **액션**
   - 시간이 지남에 따라 안전하게 상태를 바꿀 수 있는 방법
   - 순서를 보장하는 방법
   - 액션이 정확히 한 번만 실행되게 보장하는 방법
2. **계산**
   - 정확성을 위한 정적 분석
   - 소프트웨어에서 쓸 수 있는 수학적 지식
   - 테스트 전략
3. **데이터**
   - 효율적으로 접근하기 위해 데이터를 구성하는 방법
   - 데이터를 보관하기 위한 기술
   - 데이터를 이용해 중요한 것을 발견하는 원칙

### 그럼 액션, 계산, 데이터를 구분하면 어떠한 장점이 있는가?

함수형 프로그래밍은 요즘 유행하는 분산 시스템에 잘 어울린다.
여러 컴퓨터가 네트워크를 통해 통신하기 시작하면 소프트웨어가 복잡해진다.

처리해야할 메시지는 순서가 섞일 수 있고 중복되기도 하고 유실되기도 한다.

**시간에 따라 바뀌는 값을 모델링**할 때 동작 방법을 이해하는 것은 중요하지만 쉽지는 않다.
실행 시점이나 횟수에 의존하는 코드를 없애면, 코드를 더 쉽게 이해할 수 있고 심각한 버거를 막을 수 있다.

데이터와 계산은 실행 시점이나 횟수에 의존하지 않는다. 그래서 코드를 데이터와 계산으로 바꿀수록 분산 시스템에서 생기는 여러가지 문제를 해결할 수 있다.

**액션**은 실행 시점과 횟수에 의존하기 때문에 여전히 문제가 되지만, 코드 전체에 영향을 주지 않도록 격리시킨다.
그리고 코드의 많은 부분을 액션에서 계산으로 옮기면 결과적으로 액션도 다루기 쉬워진다.

> 분산 시스템 규칙 3가지
>
> 1. 메시지 순서가 바뀔 수 있다.
> 2. 메시지는 한 번 이상 도착할 수도 있고 도착하지 않을 수도 있다.
> 3. 응답을 받지 못하면 무슨 일이 생겼는지 알 수 없다.
>
> 분산 시스템이 되면 모든 것이 복잡해진다.

여기까지를 읽었을 때에, 우리가 실제로 어플에서 토스트 메시지를 띄워줘야하는 상황이 생각났다.
어떠한 메시지를 서버로부터 하나 받게 되었을때 토스트 메시지를 띄워줘야한다.
그런데 이미 토스트 메시지가 띄워져있는 상황에서
추가적인 메시지가 서버로부터 전달되었을 때 상황이라면 어떨까?

이러한 것들을 계산을 통해 좀 더 간결하고 복잡성이 낮아지도록 구현할 수 있겠다는 느낌이 들었다.

---

### 함수형 사고란 무엇인가?

함수형 사고는 함수형 프로그래머가 소프트웨어 문제를 해결하기 위해 사용하는 기술과 생각을 말한다.
여러 가지 기술과 생각이 있겠지만, 그 중 함수형 프로그래밍에서 가장 중요하다고 생각하는 두 가지 개념은 다음과 같다.

첫 번째는 액션과 계산, 데이터를 구분해서 생각하는 것이고, 두 번재는 일급 추상이라는 개념이다.
이 두 가지 개념은 함수형 프로그래밍에서 실용적이고 튼튼한 프로그램을 만드는 기초가 된다.

---

### 결론

함수형 프로그래밍 기술과 원칙에 대한 지식은 방대하다. 하지만 그 모든 것은 액션과 계산, 데이터를 구분하는 것부터 시작한다.

액션은 시간에 의존한다. 그래서 사용하기 가장 어렵다. 액션에서 시간에 의존하는 부분을 분리하면 좀 더 다루기 쉽다.
계산은 시간에 의존적이지 않다. 다루기 쉽기 때문에 가능한 코드를 계산으로 바꾸는 것이 좋다.
데이터는 정적이고 해석이 필요하다. 데이터는 저장하거나 이해하기 쉽고 전송하기 편리하다.

---

### 느낌

데이터를 인포메이션으로 바꾸어 제공하는 것이 프로그래밍이라고 하는 말을 들은 적이 있다.
여기서 데이터란 그냥 세상의 모든 떠돌아다니는 수많은 정보들인데,
그러면 인포메이션은 무엇일까?

인포메이션은 수많은 데이터들을 모아, 정말 필요한 사람들에게 관계를 맺어주어,
그 사람들이 찾고 싶어 하거나 제공받음으로써 자신의 삶에 영향을 미칠 수 있는 것들이다.

하지만 이러한 인포메이션은 그냥 나오지는 않는다.
수많은 데이터들 중에서 필요한 사람들에게 좋은 인포메이션을 제공하기 위해
프로그래머는 좋은 코드를 짜고 깊은 고민을 하는 설계를 하게 된다.

함수형 프로그래밍이란 결국 이러한 프로그래밍의 과정을 돕는 하나의 도구일 것이다.
좀 더 세밀하게, 좀 더 정확하게 타겟팅된 사람들에게
그 사람들의 삶에 좋은 영향을 미칠 수 있는 인포메이션을 제공해주는 것.
그게 프로그래머가 해야하는 일인 것이다.

여기서 말하는 사람들이란, 일반 유저들을 얘기할 수도 있고 나와 함께 코드를 짜는 동료일 수도 있다.
이 스터디를 끝마쳤을 때 좀 더 나은 인포메이션을 제공할 수 있는 프로그래머가 될 수 있길 기대해본다.

---

## Chapter 2. 현실에서의 함수형 사고

### 파트 1. 액션과 계산, 데이터

함수형 프로그래머는 코드에서 가장 먼저 이 세 가지를 구분하는데, 이는 **쉽게 다룰 수 있는 부분과 조심히 다뤄야 할 부분을 명확하게 하기 위함이다.**

1. 액션
   - 액션은 호출 횟수와 시점에 의존하는 것이다.
   - 아직은 이러한 설명이 조금 추상적일 수 있지만 차차 이해할 수 있을 것이다.
2. 계산
   - 어떤 것을 결정하거나 계획하는 것은 계산이다.
   - **계산은 실행해도 다른 곳에 영향을 주지 않는다.**
3. 데이터
   - 데이터는 유연하기 때문에 저장하거나 네트워크로 전송하는 등 다양하게 쓸 수 있다.

앞으로 우리는 모든 계층에서 액션과 계산, 데이터를 구분해 보는 것, 액션과 계산, 데이터가 서로 어떻게 상호작용하는지 아는 것.
이러한 것들을 차차 알아본다.
이에 대한 알게 되면, 액션과 계산을 구분할 수 있고, 액션과 계산을 자유롭게 옮길 수 있다.

### 계층형 설계 (변경 가능성에 따라 코드를 나눈다)

이렇게 계층형 설계로 만든 코드는 테스트, 재사용, 유지보수가 쉽다는 장점이 있다.

계층형 설계는 일반적으로 비즈니스 규칙, 도메인 규칙, 기술 스택 계층으로 나눈다.
기술 스택이 가장 기반에 깔려있으며, 그 위에 도메인 규칙, 그 위에 비즈니스 규칙 순으로 위로 간다.
각 계층은 그 아래에 있는 계층을 기반으로 만들어진다. 그래서 각 계층에 있는 코드는 더 안정적인 기반 위에 작성할 수 있다.

```
나는 이러한 내용을 읽으면서,
결국 레이어 분리에 대한 고민은
좋은 코드를 설계하는데 항상 필요하고 많은 사람들이 고민을 해왔구나 라는 것을 또 다시 느꼈다.
```

### 파트 2. 일급 추상

피자 가게를 예시를 들어서 타임라인에 대한 얘기들을 한다.
이러한 예시들은 결국 "서로 맞춰지지 않은 분산 시스템은 예측 불가능한 순서로 실행되버린다"
를 설명한다.

그렇다면, 예측 가능하게 만드는 것이 중요할 것이다.
어떻게 개선할 수 있을까?

여기서 **커팅**이라는 개념이 나오게 되는데,
이를 예시를 들어 설명하자면, "로봇이 서로를 기다릴 수 있게 하기"가 되겠다.
타임라인 커팅이란, 여러 타임라인이 동시에 진행될 때 서로 순서를 맞추는 방법이다.

타임라인 커팅은 **고차 동작**으로 구현한다.
각 타임라인은 독립적으로 동작하고 작업이 완료되면 다른 타임라인이 끝나기를 기다리기 때문에 어떤 타임라인이 먼저 끝나도 괜찮다.

### 결론

상세 구현은 몇 장에서 하겠습니다. 라는 식의 글들이 나와있어서
현재 챕터 2 정리본에 쓸 수 있는 글이 한정적이다.

다만 요점을 정리해보자면 다음과 같다.

1. 액션과 계산, 데이터를 구분하는 일은 함수형 프로그래머에게 가장 중요하고 첫 번째로 해야하는 일이다.
2. 함수형 프로그래머는 유지보수를 잘 하기 위해 계층형 설계를 사용한다. 각 계층은 코드의 변경 가능성에 따라 나눈다.
3. 타임라인 다이어그램은 시간에 따라 변하는 액션을 시각화하는 방법이다. 타임라인 다이어그램으로 액션이 다른 액션과 어떻게 연결되는지 볼 수 있다.
4. 액션 간 협력을 위해 타임라인 커팅이라는 기술을 사용할 수 있다. 타임라인 커팅은 액션이 올바른 순서로 실행될 수 있도록 보장해준다.

앞으로 기대할 수 있는 것들은 다음과 같다.

1. 액션과 계산, 데이터를 구분할 수 있게 된다.
2. 읽기 쉽고 테스트하기 쉬운 코드를 위해 액션을 계산으로 리팩토링할 수 있게 된다.
3. 액션을 잘 설계해서 재사용성을 높이는 방법을 터득한다.
4. 의미 있는 계층으로 코드를 구성한다.

---

## Chapter 3. 엑션과 계산, 데이터의 차이를 알기

일반적인 코드에서는 액션이 너무 많이 사용되고 있는 반면에 계산은 거의 찾아보기 힘들다.
맞다.
함수형 사고에 대한 얘기를 들어보지 않았다면 액션과 계산에 대한 개념조차 몰랐을 터이니 그럴 수 있다.
하지만 액션은 코드 전체로 퍼질 수 있다는 것을 이해해야한다.

액션은 실행 시점과 횟수에 의존한다.
이는 다른 말로 부수 효과, 부수 효과가 있는 함수, 순수하지 않은 함수라고 부르기도 한다.

계산은 입력으로 출력을 계산한다.
다른 말로 순수 함수, 수학 함수라고 부르기도 한다.

데이터는 이벤트에 대한 사실이며 액션과 계산의 입력과 출력으로 사용된다.

엑션과 계산, 데이터는 어디에나 적용할 수 있다.
처음에는 엑션과 계산, 데이터를 적용하기 어려울 수 있지만, 연습 할수록 더 잘할 수 있다.

또한 액션 안에는 계산과 데이터, 또 다른 액션이 숨어 있을지도 모른다.
단순해 보이는 액션도 또 다른 액션이나 계산, 데이터로 나눌 수 있다.
함수형 프로그래밍에서는 액션을 더 작은 액션과 계산, 데이터로 나누고
나누는 것을 언제 멈춰야 할 지 아는 것이 중요하다.

계산은 더 작은 계산과 데이터로 나누고 연결할 수 있으며 이렇게 계산을 더 작은 계산으로 나누는 것이 더 좋을 때도 있다.
계산을 나누면 첫 번째 계산의 결과의 데이터가 두 번째 계산의 입력이 된다.

데이터는 데이터만 조합할 수 있다.
데이터는 다른 영향을 주지 않는 그냥 데이터이다. 따라서 데이터를 찾는 일을 먼저 해야 한다.
데이터를 찾았다면 동작에 대한 많은 것을 알 수 있다.

때때로 계산의 단계가 잘 보이지않는 이유는 계산이 우리 사고 과정에 녹아있기 때문이다.
그렇기 때문에 이 사실을 미리 뇌리에 새기고 계산을 찾는다면 더 쉽게 찾을 수 있다.
어떤 단계에서 무엇인가 결정해야 할 것이 있는지 또는 무엇인가 계획해서 방법을 찾아야 할 것이 있는지 스스로에게 물어보면 된다.
결정과 계획은 계산이 될 가능성이 높다.

### 데이터에 대해 자세히 알아보기

데이터는 이벤트에 대한 사실이다. 일어난 일의 결과를 기록한 것이다.

**데이터를 어떻게 구현하는가?**
자바스크립트에서는 기본 데이터 타입으로 데이터를 구현한다. 숫자나 문자, 배열, 객체 같은 것들이다.

**어떻게 데이터에 의미를 담을 수 있는가?**
데이터 구조로 의미를 담을 수 있다. 예를 들어 목록의 순서가 중요하다면 순서를 보장하는 데이터 구조로 사용하면 된다.
즉 데이터 구조로도 도메인을 표현할 수 있다.

**불변성에 대해**
함수형 프로그래머는 불변 데이터 구조를 만들기 위해 두 가지 원칙을 사용한다.

1. 카피-온-라이트
   - 변경할 때 복사본을 만든다.
2. 방어적 복사
   - 보관하려고 하는 데이터의 복사본을 만든다.

데이터를 언제나 쉽게 해설할 수 있도록 표현하는 것이 함수형 프로그램에서 중요한 기술이다.

**데이터의 장점은 무엇인가요?**
역설적으로 데이터는 데이터 자체로 할 수 있는 것이 없기 때문에 좋다. 그래서 데이터는 데이터 그대로 이해할 수 있다.

1. 직렬화
   <br />
   직렬화된 액션과 계산은 다른 곳에서 잘 동작할 것이라는 보장이 없다.
   하지만 직렬화된 데이터는 전송하거나 디스크에 저장했다가 읽기 쉽다.
2. 동일성 비교
   <br />
   계산이나 액션은 서로 비교하기 어렵다. 하지만 데이터는 비교하기 쉽다.
3. 자유로운 해석
   <br />
   데이터는 여러 가지 방법으로 해석할 수 있다. 예를 들어 접속 로그는 문제 해결을 위해 사용할 수 있지만, 모니터링을 위해 사용할 수도 있다.

**데이터의 단점은 무엇인가요?**
유연하게 해석할 수 있다는 점은 장점이지만, 해석이 반드시 필요하다는 점은 단점이다.
계산은 해석하지 않아도 실행할 수 있다. 하지만 해석하지 않은 데이터는 쓸모없는 바이트일 뿐이다.

### 계산에 대해 자세히 알아보기

계산은 입력값으로 출력값을 만드는 것이다. 호출 시점이나 횟수에 의존하지 않고 동일한 입력값으로 부르면 항상 같은 결괏값(출력값)을 돌려줘야 한다.

**왜 액션보다 계산이 좋나요?**

1. 테스트하기 쉽다. 계산은 언제 어디서나(로컬 장비, 빌드 서버, 테스트 장비) 원하는만큼 테스트를 실행할 수 있다.
2. 기계적인 분석이 쉽다. 학술 연구에 정적 분석이라는 것이 있다. 정적 분석에서 자동화된 분석은 중요하다.
3. 계산은 조합하기 좋다. 계산을 조합해 더 큰 계산을 만들 수 있다. 이때 일급 계산을 사용하는데, 이는 추후 알아본다.

**계산을 쓰면서 걱정하지 않아도 되는 것**
함수형 프로그래머는 가능하면 액션보다 계산을 사용하려고 한다. 왜냐하면 계산이 더 이해하기 쉽기 때문이다. 계산은 읽기 쉽고 무엇을 하는지 이해하기도 쉽다. 아래는 계산을 쓰면서 걱정하지 않아도 되는 것들디다.

1. 동시에 실행되는 것
2. 과거에 실행되었던 것이나 미래에 실행할 것
3. 실행 횟수

**계산의 단점**
계산과 액션은 실행하기 전에 어떤 일이 발생할지 알 수 없다는 단점이 있다.
물론 코드를 읽으면 에상할 수 있긴 하다.
하지만 소프트웨어 측면에서 함수는 블랙박스이다. 입력값으로 실행해야 결과를 알 수 있다.
이러한 단점이 싫다면 계산이나 액션 대신 데이터를 사용해야 한다.

**계산은 일반적으로 무엇이라고 하나요?**
다른 책에서 보통 순수 함수 또는 수학 함수라고 부른다.
이 책에서는 자바스크립트 함수처럼 언어 기능과 혼동을 피하기 위해 계산이라고 부른다.

> 함수형 프로그래밍의 대부분은 계산을 가지고 하는 일이다. 계산을 일반적으로 함수형 프로그래밍 외부에 있는 액션을 통해 수행된다.

### 액션에 대해 자세히 알아보기

액션은 외부 세계에 영향을 주거나 받는 것을 말한다.
그리고 액션은 실행 시점과 횟수에 의존한다.

- 언제 실행되는지 - 순서
- 얼마나 실행되는지 - 반복

**액션은 일반적으로 무엇이라고 하나요?**
다른 책에서 액션은 순수하지 않은 함수, 부수 효과 함수, 부수 효과가 있는 함수라고 부른다.

**액션은 쉽지 않다**

- 액션은 다루기 힘들다.
- 액션은 우리가 소프트웨어를 실행하려는 가장 중요한 이유이다.

액션은 사용하기 어렵다. 하지만 액션은 꼭 써야 한다.
함수형 프로그래머는 액션을 잘 사용해야 한다.
다음은 액션을 잘 사용하기 위한 방법이다.

1. 가능한 액션을 적게 사용해야한다. 액션을 전혀 쓰지 않을 수 없다. 하지만 액션 대신 계산을 사용할 수 있는지 생각해봐야한다.
2. 액션은 가능한 작게 만든다. 액션에서 액션과 관련없는 코드는 모두 제거한다. 예를 들어, 액션에서 결정이나 계획과 관련된 부분은 계산으로 빼낼 수 있다.
3. 액션이 외부 세계와 상호작용하는 것을 제한할 수 있다. 액션은 외부 세계에 영향을 주거나 받을 수 있다. 내부에 계산과 데이터만 있고 가장 바깥쪽에 액션이 있는 구조가 이상적이다. 이에 대해서는 어니어 아키텍쳐에 대해 추후 다룰 때 더 자세히 알아본다.
4. 액션이 호출 시점에 의존하는 것을 제한한다. 함수형 프로그래머는 액션이 호출 시점과 횟수에 덜 의존하도록 만드는 기술을 알아야 한다. 그래야 액션을 사용할 때 조금 더 쉽게 사용할 수 있다.

---

### 결론

계산은 계획이나 결정을 할 때 적용했고 데이터는 계획하거나 결정한 결과였다. 마지막으로 액션을 통해 계산으로 만든 계획을 실행할 수 있다.

- 함수형 프로그래머는 액션과 계산, 데이터를 구분한다.
- 액션은 실행 시점이나 횟수에 의존한다. 일반적으로 액션은 외부 세계에 영향을 주거나 받는다.
- 계산은 입력값으로 출력값을 만드는 것이다. 외부 세계에 영향을 주거나 받지 않고 실행 시점이나 횟수에 의존하지 않는다.
- 데이터는 이벤트에 대한 사실이다. 사실은 변하지 않기 때문에 영구적으로 기록할 수 있다.
- 함수형 프로그래머는 액션보다 계산을 좋아하고 계산보다 데이터를 좋아한다.
- 계산은 같은 입력값을 주면 항상 같은 출력값이 나오기 때문에 액션보다 테스트하기 쉽다.
